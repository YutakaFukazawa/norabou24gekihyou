# 劇評ツール プロンプト作成ガイド

このドキュメントでは、劇評ツールで使用するプロンプトファイルの作成方法について詳しく説明します。

## 目次

- [劇評ツール プロンプト作成ガイド](#劇評ツール-プロンプト作成ガイド)
  - [目次](#目次)
  - [プロンプトファイルの概要](#プロンプトファイルの概要)
  - [プロンプトファイルの構造](#プロンプトファイルの構造)
  - [各プロンプトファイルの詳細](#各プロンプトファイルの詳細)
    - [extraction.txt（意見抽出）](#extractiontxt意見抽出)
      - [目的](#目的)
      - [サンプル](#サンプル)
    - [labelling.txt（クラスターラベリング）](#labellingtxtクラスターラベリング)
      - [目的](#目的-1)
      - [サンプル](#サンプル-1)
    - [takeaways.txt（クラスター要約）](#takeawaystxtクラスター要約)
      - [目的](#目的-2)
      - [サンプル](#サンプル-2)
    - [overview.txt（全体概要生成）](#overviewtxt全体概要生成)
      - [目的](#目的-3)
      - [サンプル](#サンプル-3)
  - [効果的なプロンプトの書き方](#効果的なプロンプトの書き方)
    - [1. 明確な指示を与える](#1-明確な指示を与える)
    - [2. 出力形式を指定する](#2-出力形式を指定する)
    - [3. 制約条件を設定する](#3-制約条件を設定する)
    - [4. コンテキストを提供する](#4-コンテキストを提供する)
    - [5. プロンプトをテストし、改善する](#5-プロンプトをテストし改善する)
  - [プロンプトのカスタマイズ例](#プロンプトのカスタマイズ例)
    - [特定のドメイン向けにカスタマイズ](#特定のドメイン向けにカスタマイズ)
    - [多言語対応](#多言語対応)
    - [データ可視化向けの調整](#データ可視化向けの調整)

## プロンプトファイルの概要

劇評ツールでは、以下の4種類のプロンプトファイルを使用します：

1. **extraction.txt**: コメントから意見を抽出するためのプロンプト
2. **labelling.txt**: クラスターにラベルを付けるためのプロンプト
3. **takeaways.txt**: クラスターの要約を生成するためのプロンプト
4. **overview.txt**: 全体の概要を生成するためのプロンプト

これらのプロンプトファイルは、AIモデル（AnthropicまたはOpenAI）に指示を与えるために使用されます。プロンプトの内容によって、AIの出力が大きく変わるため、目的に合わせて適切にカスタマイズすることが重要です。

## プロンプトファイルの構造

各プロンプトファイルは、以下の構造を持ちます：

```
/system
（システムプロンプト）

/human
（ユーザープロンプト）
```

- **システムプロンプト**: AIモデルの役割や動作を定義します。例えば、「あなたは意見を抽出するエキスパートです」など。
- **ユーザープロンプト**: 具体的なタスクや指示を提供します。例えば、「以下のコメントから主要な意見を抽出してください」など。

注意：
- `/system`と`/human`の間には空行を入れてください。
- ユーザープロンプトの後には、実際のデータ（コメントなど）が自動的に追加されます。

## 各プロンプトファイルの詳細

### extraction.txt（意見抽出）

このプロンプトは、コメントから意見を抽出するために使用されます。

#### 目的
- コメントから主要な意見や論点を抽出する
- 冗長な表現や関連性の低い情報を除外する
- 抽出した意見をJSON形式で構造化する

#### サンプル

```
/system
あなたは、コメントから主要な意見や論点を抽出するエキスパートです。
与えられたコメントから、最も重要な意見や論点を抽出し、簡潔な形で提示してください。
冗長な表現や関連性の低い情報は除外し、本質的な内容に焦点を当ててください。

各コメントから抽出した意見は、以下のJSON形式で出力してください：
[
  "意見1",
  "意見2",
  ...
]

複数の意見が含まれる場合は、それぞれを別々の要素として出力してください。
意見が1つしかない場合でも、JSON配列の形式を維持してください。

/human
以下のコメントから主要な意見を抽出してください：
```

### labelling.txt（クラスターラベリング）

このプロンプトは、クラスターにラベルを付けるために使用されます。

#### 目的
- クラスター内の意見の共通テーマを特定する
- クラスターを代表する簡潔で明確なラベルを生成する
- クラスターの特徴を的確に表現する

#### サンプル

```
/system
あなたは、テキストクラスタリングの専門家です。
与えられた意見のクラスターに対して、そのクラスターの内容を最もよく表すラベルを作成してください。

ラベルは以下の条件を満たす必要があります：
1. 簡潔であること（5〜10単語程度）
2. クラスター内の意見の共通テーマを捉えていること
3. 具体的であること（「その他」や「雑多な意見」などの曖昧なラベルは避ける）
4. 他のクラスターと区別できること

ラベルのみを出力してください。説明や追加のコメントは不要です。

/human
以下は、あるクラスターに含まれる意見の例です。このクラスターに適切なラベルを付けてください：
```

### takeaways.txt（クラスター要約）

このプロンプトは、クラスターの要約を生成するために使用されます。

#### 目的
- クラスター内の意見を総合的に分析する
- クラスターの主要なテーマや傾向を特定する
- クラスターの内容を簡潔かつ包括的に要約する

#### サンプル

```
/system
あなたは、意見分析と要約のエキスパートです。
与えられた意見のクラスターを分析し、その主要なテーマや傾向を特定し、簡潔かつ包括的な要約を作成してください。

要約は以下の条件を満たす必要があります：
1. 150〜250単語程度の長さ
2. クラスター内の主要な意見や論点を網羅していること
3. 意見の多様性や対立点がある場合はそれも含めること
4. 客観的な表現を使用すること

要約のみを出力してください。追加の分析や推奨事項は不要です。

/human
以下は、あるクラスターに含まれる意見のリストです。これらの意見を分析し、要約してください：
```

### overview.txt（全体概要生成）

このプロンプトは、全体の概要を生成するために使用されます。

#### 目的
- 全てのクラスターの分析結果を統合する
- 作品ごとの傾向や特徴を特定する
- 全体的な洞察や結論を導き出す
- 結果をJSON形式で構造化する

#### サンプル

```
/system 
あなたはシンクタンクで働くエキスパート研究アシスタントです。
あなたのチームは、あるトピックについて一般からの「意見」を募集し、さまざまな選択肢の分析を開始しました。

あなたは今、各クラスターの簡単な分析を添えたクラスターのリストを受け取ります。
あなたの仕事は、調査結果の簡単な要約(概要)と、自分のエキスパート研究アシスタントからみた知見を返すことです。

「意見」をまとめた情報について、「作品」ごとにまとめてJSON形式で出力してください。
「作品」はcsvのカラムで分類されています。
general_overviewは非常に簡潔でなければなりません（最大4文）で、ありきたりの表現は避けてください。

以下の構造を持つJSONオブジェクトを返してください：

{
  "general_overview": "全体の概要をここに記載（最大4文）",
  "categories": [
    {
      "title": "作品の名称",
      "detail": [
        {
            "overview": "作品の概要"
            "content": "作品の（推測する）内容",
            "link": "意見と意見のつながり。クラスタで分類して下さい。",
            "good": "どのような点がよかったか",
            "bad": "どのような問題点があるか。それらはどう解決したらよいか。",
      }
      ]
    },
  ]
}

/human
以下は、クラスター分析の結果です。これらの情報を基に、全体の概要と作品ごとの分析を行ってください：
```

## 効果的なプロンプトの書き方

### 1. 明確な指示を与える

- AIに何をしてほしいのかを具体的に説明する
- 曖昧な表現や複数の解釈が可能な指示は避ける
- タスクを小さなステップに分解する

### 2. 出力形式を指定する

- 期待する出力形式（JSON、テキスト、リストなど）を明示する
- 必要な場合は、出力例を提供する
- 特に構造化データ（JSON）の場合は、スキーマを詳細に指定する

### 3. 制約条件を設定する

- 出力の長さ（単語数、文字数）を指定する
- 使用すべき/避けるべき表現や用語を指定する
- 客観性、中立性などの要件を明確にする

### 4. コンテキストを提供する

- タスクの背景や目的を説明する
- 関連する情報や参考資料を提供する
- 対象となる読者や利用シーンを明確にする

### 5. プロンプトをテストし、改善する

- 実際にAIモデルで試してみる
- 期待通りの結果が得られない場合は、プロンプトを調整する
- 複数のバリエーションを試して、最も効果的なものを選ぶ

## プロンプトのカスタマイズ例

### 特定のドメイン向けにカスタマイズ

例えば、演劇の評価に特化したextraction.txtのカスタマイズ：

```
/system
あなたは、演劇評論の専門家です。
与えられた劇評から、以下のカテゴリに関連する意見を抽出してください：
1. 演出・演技
2. 脚本・物語
3. 舞台装置・照明・音響
4. 観客体験・感情的反応
5. 批評的考察

各カテゴリについて、最も重要な意見を抽出し、以下のJSON形式で出力してください：
[
  "カテゴリ1に関する意見",
  "カテゴリ2に関する意見",
  ...
]

全てのカテゴリに関する意見が含まれているとは限りません。
意見が見つからないカテゴリは省略してください。

/human
以下の劇評から主要な意見を抽出してください：
```

### 多言語対応

例えば、日英バイリンガル対応のlabelling.txt：

```
/system
あなたは、テキストクラスタリングの専門家で、日本語と英語のバイリンガルです。
与えられた意見のクラスターに対して、そのクラスターの内容を最もよく表すラベルを日本語と英語の両方で作成してください。

ラベルは以下の条件を満たす必要があります：
1. 簡潔であること（5〜10単語程度）
2. クラスター内の意見の共通テーマを捉えていること
3. 具体的であること（「その他」や「雑多な意見」などの曖昧なラベルは避ける）
4. 他のクラスターと区別できること

以下の形式で出力してください：
日本語: [日本語のラベル]
English: [英語のラベル]

/human
以下は、あるクラスターに含まれる意見の例です。このクラスターに適切なラベルを付けてください：
```

### データ可視化向けの調整

例えば、データ可視化に特化したoverview.txt：

```
/system
あなたはデータ可視化と分析の専門家です。
与えられたクラスター分析の結果を基に、全体の概要と各カテゴリの分析を行い、
データ可視化に適した形式でJSON出力を生成してください。

特に以下の点に注目してください：
1. クラスター間の関係性や階層構造
2. 意見の分布や傾向
3. 特徴的なキーワードや表現
4. 感情分析（ポジティブ/ネガティブ/中立）

以下の構造を持つJSONオブジェクトを返してください：
{
  "general_overview": "全体の概要（最大4文）",
  "categories": [
    {
      "title": "カテゴリ名",
      "detail": [
        {
          "overview": "カテゴリの概要",
          "keywords": ["キーワード1", "キーワード2", ...],
          "sentiment": {
            "positive": 0.7,
            "negative": 0.2,
            "neutral": 0.1
          },
          "clusters": [
            {
              "name": "クラスター名",
              "size": 15,
              "representative_comments": ["代表的なコメント1", "代表的なコメント2"]
            },
            ...
          ]
        }
      ]
    },
    ...
  ]
}

/human
以下は、クラスター分析の結果です。これらの情報を基に、データ可視化に適した形式でJSONを生成してください：
```

これらのカスタマイズ例は、特定のニーズや用途に合わせてプロンプトを調整する方法を示しています。プロジェクトの要件に応じて、適切にプロンプトをカスタマイズすることで、より良い結果を得ることができます。
